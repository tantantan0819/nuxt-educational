(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{478:function(e,t,n){},479:function(e,t,n){"use strict";n(24),n(90),n(35);var o=n(5),r=n(55),l=n(7),c={props:["config"],data:function(){return{qiniu_url:"",configuration:{isShowList:!1,multiple:!1,limit:null,btnText:"上传",isPrompt:"",errorText:"请上传PNG、JPG、PDF、WORD、EXCEL格式的文件!",accept:".jpg, .jpeg, .png, .pdf, .excel, .docx,.psd,.PSD, .JPG, .JPEG, PNG, .PDF, .EXCEL, .DOCX"},postData:{token:"",name:"",key:""},tokenParams:{bucket:"ukec",path:"upload/user",ext:""},fileList:[]}},mounted:function(){this.configuration=this.config,this.qiniu_url=l.a.qiniu_url},methods:{beforUpload:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=t,e.size/1024/1024<30||o.$message({message:"请上传大小不能超过30MB的文件!",type:"warning"}),o.tokenParams.ext=e.name.split(".")[1],o.postData.name=e.name,n.next=7,o.uploadToken();case 7:case"end":return n.stop()}}),n)})))()},uploadToken:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,t.next=3,r.a.get("/qiniu/token",e.tokenParams).then((function(e){n.postData.token=e.token,n.postData.key=e.key}));case 3:case"end":return t.stop()}}),t)})))()},handleRemove:function(e,t){this.flieBox=t,this.$emit("uploadFile",t)},handleExceed:function(e,t){this.$message.warning("当前限制选择"+this.configuration.limit+"个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},uploadError:function(){this.$message.error(this.configuration.errorText)},successUpload:function(e,t,n){this.flieBox=n,this.$emit("uploadFile",n),"false"!=this.configuration.isPrompt&&this.$message({message:"上传成功！",type:"success"})}}},d=(n(480),n(10)),component=Object(d.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload"},[n("el-upload",{staticClass:"upload-demo",attrs:{action:e.qiniu_url,data:e.postData,"before-upload":e.beforUpload,"on-success":e.successUpload,"on-remove":e.handleRemove,"show-file-list":e.configuration.isShowList,limit:e.configuration.limit,multiple:e.configuration.multiple,"on-exceed":e.handleExceed,"file-list":e.fileList,"on-error":e.uploadError,accept:e.configuration.accept}},[e._v(e._s(e.configuration.btnText))])],1)}),[],!1,null,"331b40b8",null);t.a=component.exports},480:function(e,t,n){"use strict";var o=n(478);n.n(o).a},481:function(e,t,n){"use strict";var o=n(71),r=n(4),l={props:["type"],components:{UploadBtn:n(479).a},data:function(){return{postUrl:"",titleMaxLength:500,dialogVisible:!1,configuration:{isShowList:!0,multiple:!0,limit:5,btnText:"上传",errorText:"请上传PNG、JPG、PDF、WORD、EXCEL格式的文件!",accept:".jpg, .jpeg, .png, .pdf,.doc,.xls,.JPG, .JPEG, PNG, .PDF,.DOC,.XLS"},flieBox:[],postData:{token:"",name:"",key:""},tokenParams:{bucket:"ukec",path:"upload/user",ext:""},fileList:[],select:{noteType:[]},modify:{note_type:"",note_body:"",note_files:[],page_type:""},rules:{note_type:[{required:!0,message:"请选择你的修改类别",trigger:"blur"}],note_body:[{required:!0,message:"请填写你的备注",trigger:"blur"}],note_files:[{required:!0,message:"请上传你的附件",trigger:"blur"}]}}},mounted:function(){var e=this;switch(e.type){case"cv":case"CV":e.modify.page_type="cv";break;case"ps":case"个人陈述":e.modify.page_type="ps";break;case"letter":case"推荐信":e.modify.page_type="res";break;default:e.modify.page_type="cv"}var t=Object(r.e)("noteType");t?(e.select.noteType=t.NOTE_TYPE_CV,e.modify.note_type=t.NOTE_TYPE_CV[0].id):o.a.get("/code-val/group-key-list").then((function(t){e.select.noteType=t.NOTE_TYPE_CV,e.modify.note_type=t.NOTE_TYPE_CV[0].id,Object(r.k)("noteType",t)}))},computed:{isShow:function(){var e=!1,t="";return this.select.noteType.map((function(e){"内容"==e.cvalue_cn&&(t=e.id)})),this.modify.note_type==t&&(e=!e),e}},methods:{addFile:function(e){this.flieBox=e,console.log(e,"文件监听")},handleClose:function(e){this.cancel("modify")},cancel:function(e){this.$refs[e].resetFields(),this.dialogVisible=!1,this.fileList=[],this.flieBox=[]},submitForm:function(e){var t=this;0==t.flieBox.length?t.modify.note_files=[]:(t.modify.note_files=[],t.flieBox.map((function(e){t.modify.note_files.push({name:e.response.data.filename,url:e.response.data.key})}))),t.$refs[e].validate((function(n){n&&o.a.post("/customer-note/add",t.modify).then((function(n){var o=t.$message({message:"提交成功！",type:"success"});setTimeout((function(){o.close(),t.cancel(e)}),1e3)}))}))}}},c=n(10),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modify modify_upload"},[n("span",{staticClass:"cv_button modify_button",on:{click:function(t){e.dialogVisible=!0}}},[e._v("修改")]),e._v(" "),n("div",{staticClass:"add add_note"},[n("el-dialog",{attrs:{title:"",visible:e.dialogVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("div",{staticClass:"add_title"},[e._v("修改")]),e._v(" "),n("div",{staticClass:"add_content"},[n("el-form",{ref:"modify",attrs:{model:e.modify,"status-icon":"",rules:e.rules,"label-width":"300px","label-position":"top"}},[n("el-form-item",{attrs:{label:"类别:",prop:"note_type"}},[n("el-select",{staticClass:"widthAll",attrs:{placeholder:"类别"},model:{value:e.modify.note_type,callback:function(t){e.$set(e.modify,"note_type",t)},expression:"modify.note_type"}},e._l(e.select.noteType,(function(e,t){return n("el-option",{key:t,attrs:{label:e.cvalue_cn,value:e.id}})})),1)],1),e._v(" "),e.isShow?n("el-form-item",{staticClass:"modfityTip",attrs:{label:"  "}},[n("span",[e._v("内容修改只可进行1次，修改件的返还时间为72小时")])]):e._e(),e._v(" "),n("el-form-item",{staticClass:"cvTextareaBox modifyText",attrs:{label:"备注:",prop:"note_body"}},[n("el-input",{staticClass:"noteTextarea",attrs:{type:"textarea",autocomplete:"off"},model:{value:e.modify.note_body,callback:function(t){e.$set(e.modify,"note_body",t)},expression:"modify.note_body"}})],1),e._v(" "),n("el-form-item",{staticClass:"upload_lang",attrs:{label:"附件:",prop:"note_files"}},[n("upload-btn",e._g({attrs:{config:e.configuration}},{uploadFile:e.addFile}))],1)],1),e._v(" "),n("div",{staticClass:"footer_button"},[n("span",{on:{click:function(t){return e.cancel("modify")}}},[n("i",[e._v("取消")])]),e._v(" "),n("span",{on:{click:function(t){return e.submitForm("modify")}}},[e._v("提交")])])],1)])],1)])}),[],!1,null,null,null);t.a=component.exports},515:function(e,t,n){},558:function(e,t,n){"use strict";var o=n(515);n.n(o).a},597:function(e,t,n){"use strict";n.r(t);n(35);var o=n(5),r=n(71),l=n(7),c=n(4),d=n(481),m=n(479),_={name:"new",components:{InfoModify:d.a,UploadBtn:m.a},data:function(){return{img_url:"",userForm:{},cid:"",material:[],showArr:[],materialType:["个人陈述","CV","推荐信"],modifyType:"cv",addShow:!1,addForm:{origin_name:"",material_name:"",file_url:"",material_id:"",is_private:"1"},addRules:{material_name:[{required:!0,message:"请填写您的材料名称",trigger:"blur"}],origin_name:[{required:!0,message:"请上传您的材料文件",trigger:"blur"}]},configuration:{isShowList:!1,multiple:!1,limit:null,btnText:"上传",errorText:"",accept:""}}},filters:{timeFormat:function(e){return Object(c.m)(e)}},mounted:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=e).img_url=l.a.view_host,t.next=4,r.a.get("/customer/get-info");case 4:o=t.sent,n.cid=o.id,n.getMaterial();case 7:case"end":return t.stop()}}),t)})))()},methods:{getMaterial:function(){var e=this;r.a.get("/customer-material/list-by-type",{cid:e.cid}).then((function(t){t&&(e.material=t)}))},isAdd:function(e){this.addForm.material_id=e,this.addShow=!0},viewMaterial:function(e){window.open(l.a.view_host+e,"_blank")},download:function(e,t){window.open(l.a.view_host+e+"?attname="+t,"_self")},addFile:function(e){e&&(this.addForm.file_url=e[e.length-1].response.data.url,this.addForm.origin_name=e[e.length-1].response.data.filename)},cancelAdd:function(e){this.$refs[e].resetFields(),this.addShow=!1},addSubmit:function(e){var t=this;t.$refs[e].validate((function(n){n&&r.a.post("/customer-material/add",t.addForm).then((function(n){var o=t.$message({message:"提交成功！",type:"success"});setTimeout((function(){o.close(),t.$refs[e].resetFields(),t.addShow=!1,t.getMaterial()}),1e3)}))}))}}},f=(n(558),n(10)),component=Object(f.a)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"visa_table materia_table"},[e.material?n("div",{staticClass:"visa_box"},[e._m(0),e._v(" "),n("div",{staticClass:"visa_con"},e._l(e.material,(function(t,o){return n("div",{key:o,staticClass:"visa_item"},[n("div",{staticClass:"visa_left"},[e._v(e._s(t.materialname_cn))]),e._v(" "),n("div",{staticClass:"visa_con",class:{active:t.lists.length>1}},e._l(t.lists,(function(t,o){return n("div",{key:o,staticClass:"visa_center"},[n("span",[e._v(e._s(t.material_name))]),e._v(" "),n("span",[n("a",{attrs:{href:t.file_url,target:"_blank"}},[e._v(e._s(t.origin_name))])]),e._v(" "),n("span",[e._v(e._s(e._f("timeFormat")(t.create_time)))]),e._v(" "),n("span",[e._v(e._s(t.创建人))]),e._v(" "),200==t.material_status?n("span",{class:{green:200==t.material_status}},[n("i",[e._v("审核通过")])]):n("span")])})),0),e._v(" "),n("div",{staticClass:"visa_right materia_right"},[1==t.is_multi||t.lists.length<1?n("span",{staticClass:"meteria_add",on:{click:function(n){return e.isAdd(t.material_id)}}},[e._v("新增")]):n("span",{staticClass:"meteria_add",on:{click:function(t){return e.download(e.item2.file_url,e.item2.origin_name)}}},[e._v("下载")]),e._v(" "),"CV"==t.materialname_cn||"个人陈述"==t.materialname_cn||"推荐信"==t.materialname_cn?n("div",{staticClass:"material_view"},[n("info-modify",{attrs:{type:t.materialname_cn}})],1):e._e()])])})),0)]):e._e(),e._v(" "),n("div",{staticClass:"add_note"},[n("el-dialog",{attrs:{visible:e.addShow,width:"717px",center:""},on:{"update:visible":function(t){e.addShow=t}}},[n("div",{staticClass:"add_title"},[e._v("增加")]),e._v(" "),n("div",{staticClass:"add_con"},[n("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addRules}},[n("el-form-item",{attrs:{prop:"material_name",label:"材料名称"}},[n("el-input",{attrs:{placeholder:"请填写您的材料名称"},model:{value:e.addForm.material_name,callback:function(t){e.$set(e.addForm,"material_name",t)},expression:"addForm.material_name"}})],1),e._v(" "),n("el-form-item",{staticClass:"upload_lang",attrs:{prop:"origin_name",label:"文件"}},[n("el-input",{attrs:{readonly:"",placeholder:"请上传您的材料文件"},model:{value:e.addForm.origin_name,callback:function(t){e.$set(e.addForm,"origin_name",t)},expression:"addForm.origin_name"}}),e._v(" "),n("upload-btn",e._g({staticClass:"unload_btn",attrs:{config:e.configuration}},{uploadFile:e.addFile}))],1)],1),e._v(" "),n("div",{staticClass:"add_footer"},[n("span",{on:{click:function(t){return e.cancelAdd("addForm")}}},[e._v("取消")]),e._v(" "),n("span",{on:{click:function(t){return e.addSubmit("addForm")}}},[e._v("确定")])])],1)])],1)])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"visa_item visa_top"},[n("div",{staticClass:"visa_left"},[e._v("类型")]),e._v(" "),n("div",{staticClass:"visa_con"},[n("div",{staticClass:"visa_center"},[n("span",[e._v("材料名称")]),e._v(" "),n("span",[e._v("文件")]),e._v(" "),n("span",[e._v("上传时间")]),e._v(" "),n("span",[e._v("上传人")]),e._v(" "),n("span",[e._v("审核状态")])])]),e._v(" "),n("div",{staticClass:"visa_right materia_right"},[e._v("操作")])])}],!1,null,null,null);t.default=component.exports}}]);